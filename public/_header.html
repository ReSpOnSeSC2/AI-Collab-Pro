<header class="row header-row global-header py-2 align-items-center fixed-top">
    <div class="col-auto">
        <a href="hub.html" class="text-decoration-none d-flex align-items-center">
             <img src="/images/ai-collab.png" alt="AI-Collab Logo" height="90">
        </a>
    </div>
    <div class="col text-center d-flex align-items-center justify-content-center">
        <!-- User info display -->
        <div class="user-info me-2">
            <span id="header-user-info" class="small text-muted"></span>
        </div>
    </div>
    <nav class="col-auto d-flex align-items-center global-nav">
        <a href="hub.html" class="btn btn-sm btn-outline-secondary me-2" aria-label="AI Chat" title="AI Chat">
            <i class="bi bi-chat-dots-fill me-1"></i> Chat
        </a>
        <a href="model-comparison.html" class="btn btn-sm btn-outline-secondary me-2" aria-label="Model comparison" title="Compare AI models">
            <i class="bi bi-bar-chart-line me-1"></i> Compare
        </a>
        <a href="settings.html" class="btn btn-sm btn-outline-secondary me-2" aria-label="Settings" title="User Settings">
            <i class="bi bi-person-gear me-1"></i> Settings
        </a>
        <a href="security.html" class="btn btn-sm btn-outline-secondary me-2" aria-label="Security" title="Security & Privacy">
            <i class="bi bi-shield-lock me-1"></i> Security
        </a>
        <a href="admin-dashboard.html" class="btn btn-sm btn-outline-secondary me-2" aria-label="Admin Dashboard" title="Access Admin Dashboard">
            <i class="bi bi-gear me-1"></i> Admin
        </a>
        <!-- Logout button -->
        <button id="global-logout-button" class="btn btn-sm btn-outline-danger me-2" aria-label="Logout" title="Logout">
            <i class="bi bi-box-arrow-right me-1"></i> Logout
        </button>
        <!-- Theme Toggle is essential globally -->
        <button id="theme-toggle-btn" class="btn theme-toggle-btn ms-2" aria-label="Toggle theme" title="Toggle light/dark theme">
            <i class="bi bi-sun-fill light-icon"></i>
            <i class="bi bi-moon-stars-fill dark-icon"></i>
        </button>
    </nav>
</header>

<script>
// Initialize header functionality
(function() {
    // Handle auth:login event to update user info
    document.addEventListener('auth:login', (event) => {
        const user = event.detail;
        if (user && user.name) {
            const headerUserInfo = document.getElementById('header-user-info');
            if (headerUserInfo) {
                headerUserInfo.textContent = `Hello, ${user.name}`;
            }
        }
    });
    
    // Use event delegation on the document body for logout button
    document.addEventListener('click', function(e) {
        // Check if the clicked element is the logout button or its child
        const logoutBtn = e.target.closest('#global-logout-button');
        
        if (logoutBtn) {
            e.preventDefault();
            e.stopPropagation();
            
            console.log('Logout button clicked via delegation!');
            
            // Clear all auth data
            localStorage.removeItem('ai_collab_token');
            localStorage.removeItem('ai_collab_authenticated');
            localStorage.removeItem('ai_collab_user');
            localStorage.removeItem('ai_collab_email');
            localStorage.removeItem('ai_collab_name');
            
            // Always redirect to login
            console.log('Redirecting to login page...');
            window.location.href = '/login.html';
        }
    });
    
    console.log('Header logout handler initialized with event delegation');
})();
</script>